<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HackerRank GitHub Pusher</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 28px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }

      .header p {
        opacity: 0.9;
        font-size: 14px;
      }

      .content {
        padding: 30px;
      }

      .section {
        margin-bottom: 30px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 12px;
        border: 2px solid #e9ecef;
      }

      .section-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        color: #495057;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .input-group {
        margin-bottom: 15px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #495057;
        font-size: 14px;
      }

      input[type="text"],
      input[type="url"],
      textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #dee2e6;
        border-radius: 8px;
        font-size: 14px;
        font-family: inherit;
        transition: all 0.3s;
      }

      input:focus,
      textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      textarea {
        min-height: 120px;
        resize: vertical;
        font-family: "Courier New", monospace;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-secondary:hover {
        background: #5a6268;
      }

      .btn-success {
        background: #28a745;
        color: white;
      }

      .btn-success:hover {
        background: #218838;
      }

      .btn-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .extracted-data {
        background: white;
        padding: 15px;
        border-radius: 8px;
        margin-top: 15px;
        border: 1px solid #dee2e6;
      }

      .extracted-data pre {
        background: #f1f3f5;
        padding: 12px;
        border-radius: 6px;
        overflow-x: auto;
        font-size: 12px;
        max-height: 200px;
      }

      .status {
        padding: 12px;
        border-radius: 8px;
        margin-top: 15px;
        display: none;
        animation: slideIn 0.3s;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .status.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
        display: block;
      }

      .status.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
        display: block;
      }

      .status.info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
        display: block;
      }

      .icon {
        width: 20px;
        height: 20px;
      }

      .help-text {
        font-size: 12px;
        color: #6c757d;
        margin-top: 5px;
      }

      .preview-section {
        margin-top: 20px;
        padding: 15px;
        background: white;
        border-radius: 8px;
        border: 1px solid #dee2e6;
      }

      .file-preview {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 6px;
        margin-top: 10px;
        font-family: monospace;
        font-size: 12px;
        max-height: 300px;
        overflow-y: auto;
      }

      .instructions {
        background: #fff3cd;
        border: 1px solid #ffc107;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .instructions h3 {
        color: #856404;
        margin-bottom: 10px;
        font-size: 16px;
      }

      .instructions ol {
        margin-left: 20px;
        color: #856404;
      }

      .instructions li {
        margin-bottom: 5px;
        font-size: 13px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>
          <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
            />
          </svg>
          HackerRank GitHub Pusher
        </h1>
        <p>Automatically extract and push HackerRank problems to GitHub</p>
      </div>

      <div class="content">
        <div class="instructions">
          <h3>üìã How to Use:</h3>
          <ol>
            <li>Open a HackerRank problem page</li>
            <li>
              Click "Extract from HackerRank" to auto-fill question and code
            </li>
            <li>Review the extracted data and configure GitHub settings</li>
            <li>Generate files (MD, PDF, JSX) and push to GitHub</li>
          </ol>
        </div>

        <div class="section">
          <div class="section-title">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"
              />
              <path d="M14 2v6h6" />
            </svg>
            Extract Data
          </div>
          <button class="btn btn-primary" onclick="extractFromHackerRank()">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
            </svg>
            Extract from HackerRank Page
          </button>
          <div id="extractStatus" class="status"></div>
        </div>

        <div class="section">
          <div class="section-title">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
              />
            </svg>
            Question Data
          </div>
          <div class="input-group">
            <label>Problem Title</label>
            <input
              type="text"
              id="questionTitle"
              placeholder="e.g., Code Review Feedback"
            />
          </div>
          <div class="input-group">
            <label>Question Description (Markdown)</label>
            <textarea
              id="questionDescription"
              placeholder="Paste or edit question description..."
            ></textarea>
            <div class="help-text">
              Full question with requirements, examples, and constraints
            </div>
          </div>
          <div class="input-group">
            <label>Image URLs (one per line)</label>
            <textarea
              id="imageUrls"
              rows="3"
              placeholder="https://example.com/image1.gif&#10;https://example.com/image2.png"
            ></textarea>
          </div>
        </div>

        <div class="section">
          <div class="section-title">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"
              />
            </svg>
            Solution Code
          </div>
          <div class="input-group">
            <label>Code (JSX/JavaScript)</label>
            <textarea
              id="solutionCode"
              placeholder="Paste your solution code here..."
            ></textarea>
          </div>
        </div>

        <div class="section">
          <div class="section-title">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
              />
            </svg>
            GitHub Configuration
          </div>
          <div class="input-group">
            <label>GitHub Personal Access Token</label>
            <input
              type="text"
              id="githubToken"
              placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"
            />
            <div class="help-text">
              Get token from GitHub Settings ‚Üí Developer settings ‚Üí Personal
              access tokens
            </div>
          </div>
          <div class="input-group">
            <label>Repository (username/repo)</label>
            <input
              type="text"
              id="repoName"
              placeholder="username/hackerrank-solutions"
            />
          </div>
          <div class="input-group">
            <label>Folder Path (optional)</label>
            <input
              type="text"
              id="folderPath"
              placeholder="react/code-review-feedback"
            />
            <div class="help-text">Leave empty for root directory</div>
          </div>
        </div>

        <div class="section">
          <div class="section-title">
            <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"
              />
            </svg>
            Generate & Push Files
          </div>
          <div class="btn-group">
            <button class="btn btn-secondary" onclick="generateMarkdown()">
              Generate README.md
            </button>
            <button class="btn btn-secondary" onclick="generatePDF()">
              Generate PDF
            </button>
            <button class="btn btn-secondary" onclick="generateJSX()">
              Generate Solution.jsx
            </button>
            <button class="btn btn-success" onclick="pushToGitHub()">
              <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" />
              </svg>
              Push All to GitHub
            </button>
          </div>
          <div id="pushStatus" class="status"></div>
        </div>

        <div class="preview-section" id="previewSection" style="display: none">
          <h3 style="margin-bottom: 15px; color: #495057">File Preview</h3>
          <div id="filePreview" class="file-preview"></div>
        </div>
      </div>
    </div>

    <script>
      let extractedData = {
        title: "",
        description: "",
        code: "",
        images: [],
      };

      function extractFromHackerRank() {
        const status = document.getElementById("extractStatus");
        status.className = "status info";
        status.textContent = "üîç Extracting data from HackerRank page...";

        // Simulate extraction (in real extension, this would use content script)
        setTimeout(() => {
          // Extract question title
          const title =
            document
              .querySelector(".question-description h2")
              ?.textContent?.trim() || "Code Review Feedback";

          // Extract description
          let description = `# ${title}\n\n`;
          description +=
            document
              .querySelector(".question-description p")
              ?.textContent?.trim() || "";
          description += "\n\n";

          // Extract requirements
          const requirements = document.querySelectorAll(
            ".question-description ol li"
          );
          if (requirements.length > 0) {
            description += "## Detailed Requirements\n\n";
            requirements.forEach((req, index) => {
              description += `${index + 1}. ${req.textContent.trim()}\n`;
            });
          }

          // Extract images
          const images = [];
          document
            .querySelectorAll(".question-description img")
            .forEach((img) => {
              images.push(img.src);
            });

          // Extract code
          const codeEditor =
            document.querySelector("textarea") ||
            document.querySelector(".monaco-editor") ||
            document.querySelector('[class*="code"]');
          const code =
            codeEditor?.value ||
            codeEditor?.textContent ||
            `import React from "react";\n\nconst FeedbackSystem = () => {\n  return (\n    <div className="my-0 mx-auto text-center w-mx-1200">\n      <h2>Readability</h2>\n      {/* Component code */}\n    </div>\n  );\n};\n\nexport default FeedbackSystem;`;

          extractedData = { title, description, code, images };

          document.getElementById("questionTitle").value = title;
          document.getElementById("questionDescription").value = description;
          document.getElementById("solutionCode").value = code;
          document.getElementById("imageUrls").value = images.join("\n");

          status.className = "status success";
          status.textContent = "‚úÖ Data extracted successfully!";

          setTimeout(() => {
            status.style.display = "none";
          }, 3000);
        }, 1000);
      }

      function generateMarkdown() {
        const title = document.getElementById("questionTitle").value;
        const description = document.getElementById(
          "questionDescription"
        ).value;
        const imageUrls = document
          .getElementById("imageUrls")
          .value.split("\n")
          .filter((url) => url.trim());

        let markdown = `# ${title}\n\n`;
        markdown += description + "\n\n";

        if (imageUrls.length > 0) {
          markdown += "## Screenshots\n\n";
          imageUrls.forEach((url, index) => {
            markdown += `![Screenshot ${index + 1}](${url.trim()})\n\n`;
          });
        }

        markdown +=
          "## Solution\n\nSee `solution.jsx` for the complete implementation.\n\n";
        markdown +=
          "## Tags\n\nReact, JavaScript, State Management, Event Handling\n";

        showPreview("README.md", markdown);
        downloadFile("README.md", markdown);
      }

      function generateJSX() {
        const code = document.getElementById("solutionCode").value;
        showPreview("solution.jsx", code);
        downloadFile("solution.jsx", code);
      }

      async function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        const title = document.getElementById("questionTitle").value;
        const description = document.getElementById(
          "questionDescription"
        ).value;
        const code = document.getElementById("solutionCode").value;

        // Add title
        doc.setFontSize(20);
        doc.text(title, 20, 20);

        // Add description
        doc.setFontSize(12);
        const descLines = doc.splitTextToSize(description, 170);
        doc.text(descLines, 20, 35);

        // Add code section
        const yPos = 35 + descLines.length * 7;
        doc.setFontSize(14);
        doc.text("Solution Code:", 20, yPos);

        doc.setFontSize(10);
        doc.setFont("courier");
        const codeLines = doc.splitTextToSize(code, 170);
        doc.text(codeLines, 20, yPos + 10);

        // Save PDF
        doc.save(`${title.replace(/\s+/g, "-").toLowerCase()}.pdf`);

        const status = document.getElementById("pushStatus");
        status.className = "status success";
        status.textContent = "‚úÖ PDF generated and downloaded!";
        setTimeout(() => (status.style.display = "none"), 3000);
      }

      async function pushToGitHub() {
        const token = document.getElementById("githubToken").value;
        const repo = document.getElementById("repoName").value;
        const folderPath = document.getElementById("folderPath").value;
        const status = document.getElementById("pushStatus");

        if (!token || !repo) {
          status.className = "status error";
          status.textContent =
            "‚ùå Please provide GitHub token and repository name";
          return;
        }

        status.className = "status info";
        status.textContent = "üì§ Pushing files to GitHub...";

        try {
          const title = document.getElementById("questionTitle").value;
          const description = document.getElementById(
            "questionDescription"
          ).value;
          const code = document.getElementById("solutionCode").value;
          const imageUrls = document
            .getElementById("imageUrls")
            .value.split("\n")
            .filter((url) => url.trim());

          // Generate files
          let markdown = `# ${title}\n\n${description}\n\n`;
          if (imageUrls.length > 0) {
            markdown += "## Screenshots\n\n";
            imageUrls.forEach((url, index) => {
              markdown += `![Screenshot ${index + 1}](${url.trim()})\n\n`;
            });
          }

          const basePath = folderPath ? `${folderPath}/` : "";

          // Push README.md
          await pushFileToGitHub(token, repo, `${basePath}README.md`, markdown);

          // Push solution.jsx
          await pushFileToGitHub(token, repo, `${basePath}solution.jsx`, code);

          status.className = "status success";
          status.textContent = `‚úÖ Successfully pushed files to ${repo}!`;

          setTimeout(() => (status.style.display = "none"), 5000);
        } catch (error) {
          status.className = "status error";
          status.textContent = `‚ùå Error: ${error.message}`;
        }
      }

      async function pushFileToGitHub(token, repo, path, content) {
        const url = `https://api.github.com/repos/${repo}/contents/${path}`;
        const encodedContent = btoa(unescape(encodeURIComponent(content)));

        // First, check if file exists and get its SHA
        let sha = null;
        try {
          const checkResponse = await fetch(url, {
            method: "GET",
            headers: {
              Authorization: `token ${token}`,
              Accept: "application/vnd.github.v3+json",
            },
          });

          if (checkResponse.ok) {
            const data = await checkResponse.json();
            sha = data.sha;
            console.log(`File exists, SHA: ${sha}`);
          }
        } catch (e) {
          console.log("File doesn't exist, will create new file");
        }

        // Create or update the file
        const body = {
          message: sha
            ? `Update ${path.split("/").pop()}`
            : `Add ${path.split("/").pop()}`,
          content: encodedContent,
        };

        // If file exists, include SHA to update it
        if (sha) {
          body.sha = sha;
        }

        const response = await fetch(url, {
          method: "PUT",
          headers: {
            Authorization: `token ${token}`,
            "Content-Type": "application/json",
            Accept: "application/vnd.github.v3+json",
          },
          body: JSON.stringify(body),
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || `Failed to push ${path}`);
        }

        return await response.json();
      }

      function showPreview(filename, content) {
        const previewSection = document.getElementById("previewSection");
        const filePreview = document.getElementById("filePreview");

        filePreview.innerHTML = `<strong>${filename}</strong><br><br>${escapeHtml(
          content
        )}`;
        previewSection.style.display = "block";
      }

      function downloadFile(filename, content) {
        const blob = new Blob([content], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = filename;
        a.click();
        URL.revokeObjectURL(url);
      }

      function escapeHtml(text) {
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML.replace(/\n/g, "<br>");
      }
    </script>
  </body>
</html>
